<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Credibility Index</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="https://cdn.plot.ly/plotly-2.20.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #34495e;
            --text-color: #000000;
            --light-color: #ecf0f1;
            --accent-color: #3498db;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--light-color);
            padding: 0;
            margin: 0;
        }

        /* Стили для навигации и основных элементов остаются прежними */

        /* Стили для чартов */
        .chart-container {
            width: 100%;
            height: 500px;
            margin: 20px 0;
            border-radius: 10px;
            background-color: white;
            box-shadow: 0 2px 15px rgba(0,0,0,0.05);
            padding: 20px;
        }

        /* Стили для рейтинга источников */
        .source-rating-container {
            margin: 30px 0;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.05);
        }

        .rating-chart-container {
            height: 400px;
        }

        /* Стили для похожих статей */
        .similar-article {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 5px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            border-left: 4px solid var(--primary-color);
            transition: transform 0.3s ease;
        }

        .show-more-btn {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .show-more-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        /* Стили для индикаторов достоверности */
        .credibility-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 10px;
        }

        .high-credibility {
            background-color: rgba(40, 167, 69, 0.2);
            color: var(--success-color);
        }

        .medium-credibility {
            background-color: rgba(255, 193, 7, 0.2);
            color: var(--warning-color);
        }

        .low-credibility {
            background-color: rgba(220, 53, 69, 0.2);
            color: var(--danger-color);
        }
    </style>
</head>
<body>
    <!-- Навигационное меню -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white">
        <div class="container">
            <div class="logo-container">
                <svg class="logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <rect x="10" y="10" width="80" height="80" rx="10" fill="#3498db"/>
                    <path d="M30,30 L70,30 L70,70 L30,70 Z" fill="white" stroke="#2c3e50" stroke-width="2"/>
                    <path d="M40,40 L60,40 L60,60 L40,60 Z" fill="#3498db" stroke="#2c3e50" stroke-width="1"/>
                    <text x="50" y="55" font-family="Arial" font-size="12" fill="white" text-anchor="middle">MCI</text>
                </svg>
                <span class="navbar-text">Media Credibility Index</span>
            </div>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">FAQ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Feedback</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Основной контейнер -->
    <div class="container main-container">
        <!-- Заголовок страницы -->
        <div class="page-title">
            <h1 class="main-heading">Check Credibility Index of the article:</h1>
            <p class="subheading">Setting the Standard for Media Trust</p>
        </div>

        <!-- Форма для анализа статьи -->
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="form-container">
                    <h3 class="mb-4">Analyze Article</h3>
                    <form id="analysisForm">
                        <div class="mb-3">
                            <label for="articleInput" class="form-label">Article URL or Text</label>
                            <textarea class="form-control" id="articleInput" rows="6" placeholder="Paste article text or URL here..."></textarea>
                        </div>
                        <div class="mb-4">
                            <label for="sourceName" class="form-label">Source Name (optional)</label>
                            <input type="text" class="form-control" id="sourceName" placeholder="e.g., bbc.com, reuters.com">
                        </div>
                        <button type="submit" class="btn btn-analyze btn-lg">
                            <i class="bi bi-search me-2"></i> Analyze Article
                        </button>
                    </form>
                </div>

                <!-- Индикатор загрузки -->
                <div class="loading-container text-center" id="loadingIndicator">
                    <div class="spinner-border spinner" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="loading-text">Analyzing article content...</p>
                    <p class="text-muted">This may take a moment as we perform deep analysis</p>
                </div>

                <!-- Контейнер для результатов анализа -->
                <div id="analysisResults" class="analysis-container" style="display: none;">
                    <div id="analysisOutput"></div>

                    <!-- Кнопка для повторного анализа -->
                    <button id="analyzeAgainBtn" class="btn btn-analyze-again btn-lg no-print" style="display: none;">
                        <i class="bi bi-arrow-repeat me-2"></i> Analyze Again
                    </button>

                    <!-- Контейнер для чарта достоверности статьи -->
                    <div class="chart-container">
                        <h3 class="mb-4">Article Credibility Scores</h3>
                        <div id="articleCredibilityChart"></div>
                    </div>

                    <!-- Контейнер для рейтинга источников -->
                    <div class="source-rating-container">
                        <h3 class="mb-4">Source Credibility Rating</h3>
                        <div class="rating-chart-container">
                            <div id="sourceRatingChart"></div>
                        </div>
                    </div>

                    <!-- Контейнер для результатов поиска -->
                    <div class="search-results">
                        <div class="search-results-header">
                            <h2 class="search-results-title">Same Topic Articles</h2>
                            <span class="search-results-count" id="resultsCount">0 articles found</span>
                        </div>
                        <div id="similarArticles"></div>
                        <button id="showMoreBtn" class="show-more-btn" style="display: none;">
                            Show More Articles
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Футер -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6 text-center text-md-start">
                    <p class="mb-0">&copy; 2025 Media Credibility Index. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <a href="#" class="text-decoration-none me-3">FAQ</a>
                    <a href="#" class="text-decoration-none">Feedback</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Подключаем скрипты -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Кэшируем элементы DOM
        const elements = {
            analysisForm: document.getElementById('analysisForm'),
            articleInput: document.getElementById('articleInput'),
            sourceName: document.getElementById('sourceName'),
            loadingIndicator: document.getElementById('loadingIndicator'),
            analysisResults: document.getElementById('analysisResults'),
            analysisOutput: document.getElementById('analysisOutput'),
            articleCredibilityChart: document.getElementById('articleCredibilityChart'),
            sourceRatingChart: document.getElementById('sourceRatingChart'),
            similarArticles: document.getElementById('similarArticles'),
            analyzeAgainBtn: document.getElementById('analyzeAgainBtn'),
            showMoreBtn: document.getElementById('showMoreBtn'),
            resultsCount: document.getElementById('resultsCount'),
            container: document.querySelector('.container')
        };

        // Данные для рейтинга источников
        const sourceRatings = {
            sources: ['BBC News', 'Reuters', 'The Guardian', 'CNN', 'Fox News', 'Al Jazeera'],
            credibility: [92, 95, 88, 75, 60, 82],
            colors: ['#1a73e8', '#fb8c00', '#12173f', '#ff0000', '#00529b', '#a31f34']
        };

        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            // Инициализация чартов
            renderSourceRatingChart();

            if (elements.analysisForm) {
                elements.analysisForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    analyzeArticle();
                });
            }

            if (elements.analyzeAgainBtn) {
                elements.analyzeAgainBtn.addEventListener('click', function() {
                    resetAnalysis();
                });
            }

            if (elements.showMoreBtn) {
                elements.showMoreBtn.addEventListener('click', function() {
                    loadMoreArticles();
                });
            }
        });

        // Функция для сброса анализа
        function resetAnalysis() {
            elements.loadingIndicator.style.display = 'none';
            elements.analysisResults.style.display = 'none';
            elements.analyzeAgainBtn.style.display = 'none';
            elements.articleInput.value = '';
            elements.sourceName.value = '';
            elements.articleInput.focus();
        }

        // Функция для анализа статьи
        function analyzeArticle() {
            const inputText = elements.articleInput.value.trim();
            const sourceName = elements.sourceName ? elements.sourceName.value.trim() : '';

            if (!inputText) {
                showAlert('Please enter article text or URL', 'danger');
                return;
            }

            // Показываем индикатор загрузки
            elements.loadingIndicator.style.display = 'block';
            elements.analysisResults.style.display = 'none';
            elements.analyzeAgainBtn.style.display = 'none';

            // Имитация запроса к серверу
            setTimeout(() => {
                // Скрываем индикатор загрузки
                elements.loadingIndicator.style.display = 'none';

                // Показываем результаты анализа
                elements.analysisResults.style.display = 'block';
                elements.analyzeAgainBtn.style.display = 'block';
                elements.showMoreBtn.style.display = 'block';

                // Пример данных анализа
                const sampleAnalysis = `
### Credibility Analysis for: "Sample Article Title"

**Source:** Example News
**Media Owner:** Example Media Corporation
**Overall Calculated Credibility:** High (82.5%)

---

#### Analysis Scores:
- **Integrity Score:** 85.0% - Measures the overall integrity and trustworthiness.
- **Factuality Score:** 90.0% - Indicates likelihood of needing fact-checking.
- **Sentiment Score:** 0.70 - Overall emotional tone (0.0 negative, 0.5 neutral, 1.0 positive).
- **Bias Score:** 20.0% - Degree of perceived bias (0.0 low, 1.0 high).
- **Index of Credibility:** 82.5% - Overall credibility index.

---

#### Summary:
This article provides a comprehensive overview of the current situation with well-supported facts and minimal bias.

#### Key Arguments:
- Main argument 1 about the topic
- Main argument 2 supporting the first point
- Main argument 3 presenting another perspective

#### Mentioned Facts/Data:
- Fact 1 with supporting data
- Fact 2 with additional context
- Fact 3 with relevant statistics

#### Author's Purpose:
To inform readers about the current situation and provide balanced analysis.

#### Potential Biases Identified:
- Slight preference for one perspective
- Emphasis on certain aspects over others

#### Main Topics Identified:
Topic 1, Topic 2, Topic 3

#### Media Owner Influence:
The media owner, Example Media Corporation, may influence source credibility.
`;

                elements.analysisOutput.innerHTML = marked.parse(sampleAnalysis);

                // Визуализируем графики
                renderArticleCredibilityChart({
                    Integrity: 85,
                    Factuality: 90,
                    'Neutral Sentiment': 70,
                    'Low Bias': 80,
                    'Overall Credibility Index': 82.5
                });

                // Отображаем похожие статьи
                displaySimilarArticles([
                    {
                        title: "US inflation shows unexpected cooling in early 2025 data",
                        url: "https://www.bbc.com/news/world-us-canada-68555555",
                        source: "BBC News",
                        published_date: "2025-03-15",
                        description: "The latest US inflation figures for February 2025 show prices rose by 2.8% annually, down from 3.2% in January. This unexpected cooling has raised hopes that the Federal Reserve may consider interest rate cuts later this year.",
                        credibility: "High"
                    },
                    {
                        title: "US inflation cools more than expected in February 2025",
                        url: "https://www.reuters.com/business/us-inflation-cools-more-than-expected-2025-03-15/",
                        source: "Reuters",
                        published_date: "2025-03-15",
                        description: "U.S. consumer prices increased less than expected in February 2025, with the annual inflation rate falling to 2.8% from 3.2% in January. This development has increased market expectations for potential Fed rate cuts in mid-2025.",
                        credibility: "High"
                    }
                ]);

                // Прокручиваем страницу к результатам
                elements.analysisResults.scrollIntoView({ behavior: 'smooth' });
            }, 2000); // Имитация задержки сервера
        }

        // Функция для отображения похожих статей
        function displaySimilarArticles(articles) {
            if (!articles || articles.length === 0) {
                elements.similarArticles.innerHTML = '<p>No similar articles found.</p>';
                elements.resultsCount.textContent = '0 articles found';
                return;
            }

            elements.resultsCount.textContent = `${articles.length} articles found`;

            const articlesHTML = articles.map(article => `
                <div class="similar-article">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h4 class="article-title m-0">
                            <a href="${article.url}" target="_blank">${article.title}</a>
                        </h4>
                        <span class="credibility-badge ${getCredibilityClass(article.credibility)}">
                            ${article.credibility} Credibility
                        </span>
                    </div>
                    <p class="article-meta">
                        <strong>Source:</strong> ${article.source} |
                        <strong>Published:</strong> ${article.published_date}
                    </p>
                    <p class="article-content">${article.description}</p>
                </div>
            `).join('<hr>');

            elements.similarArticles.innerHTML = articlesHTML;
        }

        // Функция для загрузки дополнительных статей
        function loadMoreArticles() {
            // Имитация загрузки дополнительных статей
            setTimeout(() => {
                const additionalArticles = [
                    {
                        title: "US inflation falls to 18-month low as economic outlook improves",
                        url: "https://www.theguardian.com/business/2025/mar/15/us-inflation-rate-falls",
                        source: "The Guardian",
                        published_date: "2025-03-15",
                        description: "Inflation in the US has fallen to its lowest level in 18 months, with February 2025 data showing a 2.8% annual increase. Economists suggest this trend could lead to a more optimistic economic outlook for the remainder of 2025.",
                        credibility: "Medium"
                    },
                    {
                        title: "Fed officials signal potential rate cuts as inflation cools",
                        url: "https://www.cnn.com/2025/03/15/economy/fed-rate-cuts-inflation/index.html",
                        source: "CNN",
                        published_date: "2025-03-16",
                        description: "Federal Reserve officials have indicated that they may consider interest rate cuts later this year as inflation continues to cool. The central bank will carefully monitor economic data before making any decisions.",
                        credibility: "Medium"
                    }
                ];

                // Добавляем новые статьи к существующим
                const currentArticles = elements.similarArticles.querySelectorAll('.similar-article');
                const currentCount = currentArticles.length;

                const additionalArticlesHTML = additionalArticles.map(article => `
                    <div class="similar-article">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h4 class="article-title m-0">
                                <a href="${article.url}" target="_blank">${article.title}</a>
                            </h4>
                            <span class="credibility-badge ${getCredibilityClass(article.credibility)}">
                                ${article.credibility} Credibility
                            </span>
                        </div>
                        <p class="article-meta">
                            <strong>Source:</strong> ${article.source} |
                            <strong>Published:</strong> ${article.published_date}
                        </p>
                        <p class="article-content">${article.description}</p>
                    </div>
                `).join('<hr>');

                elements.similarArticles.innerHTML += `<hr>${additionalArticlesHTML}`;
                elements.resultsCount.textContent = `${currentCount + additionalArticles.length} articles found`;

                // Прокручиваем к новым статьям
                document.querySelector('.similar-article:last-child').scrollIntoView({ behavior: 'smooth' });
            }, 1000);
        }

        // Функция для определения класса достоверности
        function getCredibilityClass(credibility) {
            if (credibility === 'High') return 'high-credibility';
            if (credibility === 'Medium') return 'medium-credibility';
            return 'low-credibility';
        }

        // Функция для отображения уведомлений
        function showAlert(message, type) {
            const alertContainer = document.createElement('div');
            alertContainer.className = `alert alert-${type} alert-dismissible fade show`;
            alertContainer.role = 'alert';
            alertContainer.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            `;

            elements.container.prepend(alertContainer);

            setTimeout(() => {
                const alert = bootstrap.Alert.getOrCreateInstance(alertContainer);
                alert.close();
            }, 5000);
        }

        // Функция для визуализации графика достоверности статьи
        function renderArticleCredibilityChart(scores) {
            if (typeof Plotly === 'undefined') {
                console.error('Plotly не загружен!');
                showAlert('Error loading visualization library', 'danger');
                return;
            }

            const chartContainer = document.getElementById('articleCredibilityChart');
            if (!chartContainer) {
                console.error('Контейнер для чартов не найден!');
                return;
            }

            chartContainer.style.width = '100%';
            chartContainer.style.height = '500px';

            const chartData = [{
                type: 'scatterpolar',
                r: [
                    scores.Integrity || 0,
                    scores.Factuality || 0,
                    scores['Neutral Sentiment'] || 0,
                    scores['Low Bias'] || 0,
                    scores['Overall Credibility Index'] || 0
                ],
                theta: [
                    'Integrity',
                    'Factuality',
                    'Neutral Sentiment',
                    'Low Bias',
                    'Overall Credibility'
                ],
                fill: 'toself',
                name: 'Credibility Scores',
                marker: {
                    color: 'rgb(78, 115, 223)',
                    line: {
                        color: 'rgb(46, 65, 235)',
                        width: 2
                    }
                }
            }];

            const layout = {
                polar: {
                    radialaxis: {
                        visible: true,
                        range: [0, 100],
                        tickangle: 45,
                        tickfont: {
                            size: 12
                        }
                    },
                    angularaxis: {
                        direction: "clockwise",
                        rotation: 90
                    }
                },
                title: {
                    text: 'Article Credibility Radar Chart',
                    font: {
                        size: 18
                    }
                },
                showlegend: false,
                margin: {
                    l: 50,
                    r: 50,
                    t: 80,
                    b: 50,
                    pad: 10
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)'
            };

            try {
                Plotly.newPlot('articleCredibilityChart', chartData, layout, {
                    responsive: true,
                    displayModeBar: true
                });
            } catch (error) {
                console.error('Ошибка при инициализации чартов:', error);
                showAlert('Error rendering charts', 'danger');
            }
        }

        // Функция для визуализации рейтинга источников
        function renderSourceRatingChart() {
            if (typeof Plotly === 'undefined') {
                console.error('Plotly не загружен!');
                return;
            }

            const chartContainer = document.getElementById('sourceRatingChart');
            if (!chartContainer) {
                console.error('Контейнер для чартов не найден!');
                return;
            }

            chartContainer.style.width = '100%';
            chartContainer.style.height = '400px';

            const chartData = [{
                x: sourceRatings.sources,
                y: sourceRatings.credibility,
                type: 'bar',
                marker: {
                    color: sourceRatings.colors
                },
                text: sourceRatings.credibility.map((val, i) => `${sourceRatings.sources[i]}: ${val}%`),
                hoverinfo: 'text'
            }];

            const layout = {
                title: {
                    text: 'Source Credibility Rating',
                    font: {
                        size: 18
                    }
                },
                xaxis: {
                    title: 'News Sources',
                    tickangle: -45
                },
                yaxis: {
                    title: 'Credibility Score (%)',
                    range: [0, 100]
                },
                margin: {
                    l: 50,
                    r: 50,
                    b: 100,
                    t: 80,
                    pad: 10
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)'
            };

            try {
                Plotly.newPlot('sourceRatingChart', chartData, layout, {
                    responsive: true,
                    displayModeBar: true
                });
            } catch (error) {
                console.error('Ошибка при инициализации чартов:', error);
            }
        }
    </script>
</body>
</html>
